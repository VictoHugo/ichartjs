<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Sample</title>
		<meta http-equiv="keywords" content="ichartjs demo,Html5 demo,ichart demo"></meta>
		<meta http-equiv="description" content="The ichartjs's gallery center,ichartjs 示例中心"></meta>
		<script type="text/javascript" src="../../ichart-1.0.min.js"></script>
		<link rel="stylesheet" href="../css/demo.css" type="text/css"/>
		<script type="text/javascript">
				$(function(){
					var data = [
					        	{name : '广州',value : 4000,color:'#a5c2d5'},
					        	{name : '上海',value : 4200,color:'#cbab4f'},
					        	{name : '南昌',value : 3500,color:'#76a871'},
					        	{name : '哈尔滨',value : 3600,color:'#9f7961'},
					        	{name : '北京',value : 4150,color:'#a56f8f'}
				        	];
		        	
					var chart = new iChart.Column2D({
						render : 'canvasDiv',
						data: data,
						title : {text:'Average Wage Of 2012'},
						width : 800,
						height : 400,
						coordinate:{
							scale:[{
								 position:'left',	
								 start_scale:1000,
								 end_scale:5000,
								 scale_space:500
							}]
						}
					});

					/**
					 *自定义组件,画平均线。
					 */
					chart.plugin(new iChart.Custom({
							drawFn:function(){
								/**
								 *计算平均值的高度(坐标Y值)
								 */	
								var avg = chart.total/5,
									coo = chart.getCoordinate(),
									x = coo.get('originx'),
									W = coo.get('width'),
									S = coo.getScale('left'),
									bs = coo.get('brushsize'),
									H = coo.get('height'),
									h = (avg - S.start) * H / S.distance,
									y = chart.y + H - h - bs;
								
								chart.target.line(x,y,x+W,y,1,'#b32c0d')
								.textAlign('start')
								.textBaseline('middle')
								.fillText('avg:'+avg,x+W+5,y,false,'#b32c0d');
							}
					}));	
						
					chart.draw();
			});
			</script>
		</head>
		<body>
			<div id='canvasDiv'></div>
			<div class='ichartjs_info'>
				<span class='ichartjs_btn' onmouseover="this.style.color='#2f99ff'" onmouseout="this.style.color='#0b2946'" onclick="window.top.viewCode(document.getElementById('ichartjs_code').innerHTML);">View Code</span>
				<div class='ichartjs_sm'>说明</div>
				<div class='ichartjs_details'>
					这是一个柱形图例子，该例子展示了2012年5个城市平均工资的情况。并且增加了一个额外的平均线自定义组件。
				</div>
				<span class='ichartjs_sm'>备注：</span>
				<span class='ichartjs_details'>
					数据均为模拟，无实际参考价值。
				</span>
			</div>
<!-- the source code -->
<div id='ichartjs_code'>
<span class='ichartjs_keyword'>var</span> data = [
	{name : '<span class='ichartjs_keyword'>广州</span>',value : 4000,color:'<span class='ichartjs_keyword'>#a5c2d5</span>'},
   	{name : '<span class='ichartjs_keyword'>上海</span>',value : 4200,color:'<span class='ichartjs_keyword'>#cbab4f</span>'},
   	{name : '<span class='ichartjs_keyword'>南昌</span>',value : 3500,color:'<span class='ichartjs_keyword'>#76a871</span>'},
   	{name : '<span class='ichartjs_keyword'>哈尔滨</span>',value : 3600,color:'<span class='ichartjs_keyword'>#9f7961</span>'},
   	{name : '<span class='ichartjs_keyword'>北京</span>',value : 4150,color:'<span class='ichartjs_keyword'>#a56f8f</span>'}
 ];

$(<span class='ichartjs_keyword'>function</span>(){	
	<span class='ichartjs_keyword'>var</span> chart = <span class='ichartjs_keyword'>new</span> iChart.Column2D({
		render : '<span class='ichartjs_string'>canvasDiv</span>',
		data: data,
		title : {text:'Average Wage Of 2012'},
		width : 800,
		height : 400,
		coordinate:{
			scale:[{
				 position:'<span class='ichartjs_string'>left</span>',	
				 start_scale:1000,
				 end_scale:5000,
				 scale_space:500
			}]
		}
	});
	/**
	 *自定义组件,画平均线。
	 */
	chart.plugin(<span class='ichartjs_keyword'>new</span> iChart.Custom({
			drawFn:<span class='ichartjs_keyword'>function</span>(){
				/**
				 *计算平均值的高度(坐标Y值)
				 */	
				<span class='ichartjs_keyword'>var</span> avg = chart.total/5,
					coo = chart.getCoordinate(),
					x = coo.get('<span class='ichartjs_string'>originx</span>'),
					W = coo.get('<span class='ichartjs_string'>width</span>'),
					S = coo.getScale('<span class='ichartjs_string'>left</span>'),
					bs = coo.get('<span class='ichartjs_string'>brushsize</span>'),
					H = coo.get('<span class='ichartjs_string'>height</span>'),
					h = (avg - S.start) * H / S.distance,
					y = chart.y + H - h - bs;
				
				chart.target.line(x,y,x+W,y,1,'<span class='ichartjs_string'>#b32c0d</span>')
				.textAlign('<span class='ichartjs_string'>start</span>')
				.textBaseline('<span class='ichartjs_string'>middle</span>')
				.fillText('<span class='ichartjs_string'>avg:</span>'+avg,x+W+5,y,<span class='ichartjs_keyword'>false</span>,'<span class='ichartjs_string'>#b32c0d</span>');
			}
	}));
	
	chart.draw();
});
</div>
		</body>
</html>
