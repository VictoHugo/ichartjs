iChart.Sector3D=iChart.extend(iChart.Sector,{configure:function(){iChart.Sector3D.superclass.configure.apply(this,arguments);this.type="sector3d";this.dimension=iChart._3D;this.set({semi_major_axis:0,semi_minor_axis:0,cylinder_height:0,border:{color:"#BCBCBC"}});this.registerEvent("beforepop","analysing","drawRow")},drawSector:function(){this.T.sector3D(this.x,this.y,this.a,this.b,this.get("startAngle"),this.get("endAngle"),this.h,this.get("background_color"),this.get("border.enable"),this.get("border.width"),this.get("border.color"),this.get("shadow"),this.get("shadow_color"),this.get("shadow_blur"),this.get("shadow_offsetx"),this.get("shadow_offsety"),this.get("counterclockwise"))},isEventValid:function(b){return this.get("label.enable")&&this.label.isEventValid(b).valid?{valid:!0}:!iChart.inEllipse(b.offsetX-this.x,b.offsetY-this.y,this.a,this.b)?{valid:!1}:iChart.inRange(this.sA,this.eA,2*Math.PI-iChart.atan2Radian(this.x,this.y,b.offsetX,b.offsetY))?{valid:!0}:{valid:!1}},p2p:function(b,a,c,d){return{x:b+this.a*Math.cos(c)*d,y:a+this.b*Math.sin(c)*d}},tipInvoke:function(){var b=this.get("middleAngle"),a=iChart.quadrantd(b),c=this;return function(d,f){var e=c.p2p(c.x,c.y,b,0.6);return{left:2<=a&&3>=a?e.x-d:e.x,top:3<=a?e.y-f:e.y}}},labelInvoke:function(b,a){var c=this.get("middleAngle"),d=this.p2p(b,a,c,this.Z),f=this.p2p(b,a,c,1),e=iChart.quadrantd(c),g=this,h=this.get("counterclockwise");return{origin:{x:f.x,y:f.y},lineFn:function(){this.T.line(f.x,f.y+g.h/2,d.x,d.y+g.h/2,4*this.get("border.width"),this.get("border.color"),h&&c<Math.PI||!h&&c>Math.PI)},labelXY:function(){return{labelx:2<=e&&3>=e?d.x-this.width:d.x,labely:3<=e?d.y-this.height+g.h/2:d.y+g.h/2}}}},doConfig:function(){iChart.Sector3D.superclass.doConfig.call(this);this.a=this.get("semi_major_axis");this.b=this.get("semi_minor_axis");this.h=this.get("cylinder_height");iChart.Assert.gtZero(this.a);iChart.Assert.gtZero(this.b);this.pushIf("increment",iChart.lowTo(5,this.a/8));this.inc=Math.PI/180;ccw=this.get("counterclockwise");var b=function(a){a=iChart.atan2Radian(0,0,this.a*Math.cos(a),ccw?-this.b*Math.sin(a):this.b*Math.sin(a));!ccw&&0!=a&&(a=2*Math.PI-a);return a};this.sA=b.call(this,this.get("startAngle"));this.eA=b.call(this,this.get("endAngle"));this.get("label.enable")&&(this.pushIf("label.linelength",iChart.lowTo(10,this.a/8)),this.Z=this.get("label.linelength")/this.a+1,this.label=new iChart.Label(this.get("label"),this))}});