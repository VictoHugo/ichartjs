(function(h){function w(a){"string"===typeof a&&(a=document.getElementById(a));if(!a||!a.tagName||"canvas"!=a.tagName.toLowerCase())throw Error("there not a canvas element");this.canvas=a;this.c=this.canvas.getContext("2d");this.width=this.canvas.width;this.height=this.canvas.height}var v=Math.PI/90,n=Math.PI,x=2*Math.PI,s=Math.sin,t=Math.cos,m=function(a,b){return 1>=a?Math.floor(b)+0.5:Math.floor(b)},y=function(a,b,c,d){var g=d+1,f=b.x,e=b.y,i=a[c-1],l=a[c+1],j,h;c<a.length-1&&(a=i.y,c=l.x,l=l.y,j=(d*f+i.x)/g,h=(d*e+a)/g,c=(d*f+c)/g,d=(d*e+l)/g,g=(d-h)*(c-f)/(c-j)+e-d,h+=g,d+=g,h>a&&h>e?(h=Math.max(a,e),d=2*e-h):h<a&&h<e&&(h=Math.min(a,e),d=2*e-h),d>l&&d>e?(d=Math.max(l,e),h=2*e-d):d<l&&d<e&&(d=Math.min(l,e),h=2*e-d),b.rightContX=c,b.rightContY=d);b=[i.rightContX||i.x,i.rightContY||i.y,j||f,h||e,f,e];i.rightContX=i.rightContY=null;return b};w.prototype={css:function(a,b){if(h.isDefined(b))this.canvas.style[a]=b;else return this.canvas.style[a]},arc:function(a,b,c,d,g,f,e,i,h,j,o,k,p,m,q,r,n){q=!!q;r=!!r;this.save();n&&(this.c.globalCompositeOperation="destination-over");e&&this.strokeStyle(i,h);this.shadowOn(j,o,k,p,m).fillStyle(f);this.moveTo(a,b).beginPath();this.c.arc(a,b,c,d,g,q);r&&this.lineTo(a,b);this.closePath().fill();e&&this.stroke();return this.restore()},ellipse:function(a,b,c,d,g,f,e,i,h,j,o,k,p,m,q,r,n,z){r=!!r;n=!!n;this.save();z&&(this.c.globalCompositeOperation="destination-over");d&&this.strokeStyle(h,j);this.shadowOn(o,k,p,m,q).fillStyle(e).moveTo(a,b).beginPath();for(n&&this.moveTo(a,b);g<=f;)this.lineTo(a+c*t(g),b+(r?-d*s(g):d*s(g))),g+=v;this.lineTo(a+c*t(f),b+(r?-d*s(f):d*s(f))).closePath();d&&this.stroke();return this.fill().restore()},sector:function(a,b,c,d,g,f,e,i,h,j,o,k,p,m,q){j?(this.arc(a,b,c,d,g,f,e,i,h,j,o,k,p,m,q,!0),this.arc(a,b,c,d,g,f,e,i,h,!1,o,k,p,m,q,!0)):this.arc(a,b,c,d,g,f,e,i,h,!1,0,0,0,0,q,!0);return this},sector3D:function(){var a=function(a,b,g,f,e,i,l,j,o){if(l&&i<=n||!l&&e>=n)return!1;var k=function(e,i){this.lineTo(a+g*t(e),b+(i||0)+(l?-f*s(e):f*s(e)))},e=l&&i>n&&e<n?n:e,i=!l&&e<n&&i>n?n:i,p=e;for(this.fillStyle(h.dark(o)).moveTo(a+g*t(e),b+(l?-f*s(e):f*s(e))).beginPath();p<=i;)k.call(this,p),p+=v;k.call(this,i);this.lineTo(a+g*t(i),b+j+(l?-f*s(i):f*s(i)));for(p=i;p>=e;)k.call(this,p,j),p-=v;k.call(this,e,j);this.lineTo(a+g*t(e),b+(l?-f*s(e):f*s(e))).closePath().fill()},b=function(a,b,g,f,e,i,l,j){g=a+g*t(l);f=b+i+(e?-f*s(l):f*s(l));this.moveTo(a,b).beginPath().fillStyle(h.dark(j)).lineTo(a,b+i).lineTo(g,f).lineTo(g,f-i).lineTo(a,b).closePath().fill()};return function(c,d,g,f,e,i,l,j,o,k,p,m,q,r,s,t,u){m=m&&!h.isOpera;this.save().fillStyle(j);this.c.globalCompositeOperation="destination-over";var v=u?e<n/2||e>1.5*n:e>n/2&&e<1.5*n,w=u?i>n/2&&i<1.5*n:i<n/2||i>1.5*n;if(v||w)v&&b.call(this,c,d,g,f,u,l,e,j),w&&b.call(this,c,d,g,f,u,l,i,j);this.ellipse(c,d+l,g,f,e,i,j,o,k,p,m,q,r,s,t,u,!0);this.c.globalCompositeOperation="source-over";this.ellipse(c,d,g,f,e,i,j,o,k,p,!1,q,r,s,t,u,!0);a.call(this,c,d,g,f,e,i,u,l,j);return this.restore()}}(),textStyle:function(a,b,c){return this.textAlign(a).textBaseline(b).textFont(c)},strokeStyle:function(a,b,c){a&&(this.c.lineWidth=a);b&&(this.c.strokeStyle=b);c&&(this.c.lineJoin=c);return this},globalAlpha:function(a){a&&(this.c.globalAlpha=a);return this},fillStyle:function(a){a&&(this.c.fillStyle=a);return this},textAlign:function(a){a&&(this.c.textAlign=a);return this},textBaseline:function(a){a&&(this.c.textBaseline=a);return this},textFont:function(a){a&&(this.c.font=a);return this},shadowOn:function(a,b,c,d,g){h.isString(a)&&(g=d,d=c,c=b,b=!0);a&&(this.c.shadowColor=b,this.c.shadowBlur=c,this.c.shadowOffsetX=d,this.c.shadowOffsetY=g);return this},shadowOff:function(){this.c.shadowColor="white";this.c.shadowBlur=this.c.shadowOffsetX=this.c.shadowOffsetY=0},avgLinearGradient:function(a,b,c,d,g){a=this.createLinearGradient(a,b,c,d);for(b=0;b<g.length;b++)a.addColorStop(b/(g.length-1),g[b]);return a},createLinearGradient:function(a,b,c,d){return this.c.createLinearGradient(a,b,c,d)},avgRadialGradient:function(a,b,c,d,g,f,e){a=this.createRadialGradient(a,b,c,d,g,f);for(b=0;b<e.length;b++)a.addColorStop(b/(e.length-1),e[b]);return a},createRadialGradient:function(a,b,c,d,g,f){return this.c.createRadialGradient(a,b,c,d,g,f)},fillText:function(a,b,c,d,g,f,e){a+="";d=d||!1;f=f||"lr";e=e||16;this.fillStyle(g);a.split("tb"==f?"":"\n").each(function(a){try{d?this.c.fillText(a,b,c,d):this.c.fillText(a,b,c),c+=e}catch(g){console.log(g.message+"["+a+","+b+","+c+"]")}},this);return this},measureText:function(a){return this.c.measureText(a).width},moveTo:function(a,b){this.c.moveTo(a||0,b||0);return this},lineTo:function(a,b){this.c.lineTo(a||0,b||0);return this},save:function(){this.c.save();return this},restore:function(){this.c.restore();return this},beginPath:function(){this.c.beginPath();return this},closePath:function(){this.c.closePath();return this},stroke:function(){this.c.stroke();return this},fill:function(){this.c.fill();return this},text:function(a,b,c,d,g,f,e,i,h,j){return this.save().textStyle(f,e,i).fillText(a,b,c,d,g,h,j).restore()},cube:function(a,b,c,d,g,f,e,i,l,j,o,k,p,n,q,r){a=m(j,a);b=m(j,b);e=e&&0<e?e:g;d=b-e*d;c=m(j,a+e*c);d=m(j,d);k&&(this.polygon(i,l,j,o,k,p,n,q,r,!1,[a,b,c,d,c+g,d,a+g,b]),this.polygon(i,l,j,o,k,p,n,q,r,!1,[a,b,a,b+f,a+g,b+f,a+g,b]),this.polygon(i,l,j,o,k,p,n,q,r,!1,[a+g,b,c+g,d,c+g,d+f,a+g,b+f]));this.polygon(h.dark(i),l,j,o,!1,p,n,q,r,!1,[a,b,c,d,c+g,d,a+g,b]);this.polygon(i,l,j,o,!1,p,n,q,r,!1,[a,b,a,b+f,a+g,b+f,a+g,b]);this.polygon(h.dark(i),l,j,o,!1,p,n,q,r,!1,[a+g,b,c+g,d,c+g,d+f,a+g,b+f]);return this},cube3D:function(a,b,c,d,g,f,e,i,l,j,o,k){a=m(j,a);b=m(j,b);i=!i||0==i?f:i;g?(d=h.vectorP2P(c,d),c=a+i*d.x,d=b-i*d.y):(c=a+i*c,d=b-i*d);for(;6>k.length;)k.push(!1);c=m(j,c);d=m(j,d);i=[];0>d?h.isObject(k[4])&&i.push(h.applyIf({points:[a,b-e,c,d-e,c+f,d-e,a+f,b-e]},k[4])):h.isObject(k[0])&&i.push(h.applyIf({points:[a,b,c,d,c+f,d,a+f,b]},k[0]));h.isObject(k[1])&&i.push(h.applyIf({points:[c,d,c,d-e,c+f,d-e,c+f,d]},k[1]));h.isObject(k[2])&&i.push(h.applyIf({points:[a,b,a,b-e,c,d-e,c,d]},k[2]));h.isObject(k[3])&&i.push(h.applyIf({points:[a+f,b,a+f,b-e,c+f,d-e,c+f,d]},k[3]));0>d?h.isObject(k[0])&&i.push(h.applyIf({points:[a,b,c,d,c+f,d,a+f,b]},k[0])):h.isObject(k[4])&&i.push(h.applyIf({points:[a,b-e,c,d-e,c+f,d-e,a+f,b-e]},k[4]));h.isObject(k[5])&&i.push(h.applyIf({points:[a,b,a,b-e,a+f,b-e,a+f,b]},k[5]));i.each(function(a){this.polygon(a.color,l,j,o,a.shadow,a.shadowColor,a.blur,a.sx,a.sy,a.alpha,a.points)},this);return this},polygon:function(a,b,c,d,g,f,e,i,h,j,o){if(!(2>o.length)){this.save().strokeStyle(c,d).beginPath().fillStyle(a).globalAlpha(j).shadowOn(g,f,e,i,h).moveTo(o[0],o[1]);for(a=2;a<o.length;a+=2)this.lineTo(o[a],o[a+1]);this.closePath();b&&this.stroke();this.fill().restore();return this}},lines:function(a,b,c,d){if(4>a.length)return this;this.save();d&&(this.c.globalCompositeOperation="destination-over");this.beginPath().strokeStyle(b,c).moveTo(m(b,a[0]),m(b,a[1]));for(c=2;c<a.length-1;c+=2)this.lineTo(m(b,a[c]),m(b,a[c+1]));return this.stroke().restore()},bezierCurveTo:function(a){this.c.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);return this},lineArray:function(a,b,c,d,g){if(2>a.length)return this;this.save().beginPath().strokeStyle(b,c).moveTo(m(b,a[0].x),m(b,a[0].y));if(d)for(c=1;c<a.length;c++)this.bezierCurveTo(y(a,a[c],c,g));else for(c=1;c<a.length;c++)this.lineTo(m(b,a[c].x),m(b,a[c].y));return this.stroke().restore()},line:function(a,b,c,d,g,f,e){if(!g||0==g)return this;this.save();e&&(this.c.globalCompositeOperation="destination-over");return this.beginPath().strokeStyle(g,f).moveTo(m(g,a),m(g,b)).lineTo(m(g,c),m(g,d)).stroke().restore()},round:function(a,b,c,d,g,f){return this.arc(a,b,c,0,x,d,!!f,g,f)},fillRect:function(a,b,c,d){this.c.fillRect(a,b,c,d);return this},translate:function(a,b){this.c.translate(a,b);return this},backgound:function(a,b,c,d,g){this.save();this.c.globalCompositeOperation="destination-over";return this.translate(a,b).beginPath().fillStyle(g).fillRect(0,0,c,d).restore()},rectangle:function(a,b,c,d,g,f,e,i,l,j,o,k,p){this.save().translate(m(e,a),m(e,b)).beginPath().fillStyle(g).shadowOn(l,j,o,k,p);f&&h.isNumber(e)&&(this.strokeStyle(e,i),this.c.strokeRect(0,0,c,d));g&&this.fillRect(0,0,c,d);f&&h.isArray(e)&&this.strokeStyle(null,i).line(0,0,c,0,e[0],i).line(c,0,c,d,e[1],i).line(0,d,c,d,e[2],i).line(0,0,0,d,e[3],i);return this.restore()},clearRect:function(a,b,c,d){c=c||this.width;d=d||this.height;this.c.clearRect(a||0,b||0,c,d);return this},box:function(a,b,c,d,g,f,e,i,l,j,o,k,p,n){this.save();var q=m(g,a),r=m(g,b);q!=a&&(a=q,c-=1);r!=b&&(b=r,d-=1);this.translate(a,b).strokeStyle(g,f);l&&(this.c.globalCompositeOperation="destination-over");i&&this.fillStyle(i);e=0==e?0:h.parseBorder(e);h.isArray(e)?(this.beginPath().moveTo(e[0],0).lineTo(c-e[1],0),this.c.arcTo(c,0,c,e[1],e[1]),this.lineTo(c,d-e[2]),this.c.arcTo(c,d,c-e[2],d,e[2]),this.lineTo(e[3],d),this.c.arcTo(0,d,0,d-e[3],e[3]),this.lineTo(0,e[0]),this.c.arcTo(0,0,e[0],0,e[0]),this.closePath().shadowOn(j,o,k,p,n),i&&this.fill(),j&&this.shadowOff(),this.c.globalCompositeOperation="source-over",this.stroke()):(this.shadowOn(j,o,k,p,n),i&&this.fillRect(0,0,c,d),j&&this.shadowOff(),this.c.strokeRect(0,0,c,d));return this.restore()},toImageURL:function(){return this.canvas.toDataURL("image/png")},addEvent:function(a,b,c){h.Event.addEvent(this.canvas,a,b,c)}};h.Chart=h.extend(h.Painter,{configure:function(){h.Chart.superclass.configure.apply(this,arguments);this.type="chart";this.set({render:"",data:[],width:void 0,height:void 0,lineJoin:"round",align:"center",default_mouseover_css:!0,segmentRect:!0,showpercent:!1,decimalsnum:1,title:{text:"",fontweight:"bold",fontsize:20,height:30},subtitle:{text:"",fontweight:"bold",fontsize:16,height:20},footnote:{text:"",color:"#5d7f97",height:20},footnote_align:"right",title_align:"center",title_valign:"top",animation:!1,doAnimationFn:h.emptyFn,animation_timing_function:"easeInOut",duration_animation_duration:1E3,legend:{enable:!1},tip:{enable:!1}});this.registerEvent("parseData","parseTipText","beforeAnimation","afterAnimation","animating");this.T=null;this.animationed=this.rendered=!1;this.data=[];this.components=[];this.total=0},pushComponent:function(a,b){b?this.components.unshift(a):this.components.push(a)},plugin:function(a,b){this.init();a.inject(this);this.pushComponent(a,b)},toImageURL:function(){return this.T.toImageURL()},segmentRect:function(){this.T.clearRect(this.get("l_originx"),this.get("t_originy"),this.get("client_width"),this.get("client_height"))},resetCanvas:function(){this.T.backgound(this.get("l_originx"),this.get("t_originy"),this.get("client_width"),this.get("client_height"),this.get("background_color"))},animation:function(a){a.segmentRect();a.doAnimation(a.variable.animation.time,a.duration);a.resetCanvas();a.variable.animation.time<a.duration?(a.variable.animation.time++,requestAnimFrame(function(){a.animation(a)})):requestAnimFrame(function(){a.variable.animation.time=0;a.animationed=!0;a.draw();a.processAnimation=!1;a.fireEvent(a,"afterAnimation",[a])})},doAnimation:function(a,b){this.get("doAnimationFn").call(this,a,b)},add:function(a,b,c){if(this.processAnimation)return this.variable.animation.queue.push({handler:"add",arguments:[a,b,c]}),!1;h.isNumber(b);b=h.between(0,this.data.length,b);a=h.Interface.parser.call(this,a,b);this.get("legend.enable")&&this.legend.calculate(this.data,a);return a},commonDraw:function(){h.Assert.isTrue(this.rendered,this.type+" has not rendered.");h.Assert.isTrue(this.initialization,this.type+" has initialize failed.");h.Assert.gtZero(this.data.length,this.type+"'data is empty.");this.redraw||(this.title&&this.title.draw(),this.subtitle&&this.subtitle.draw(),this.footnote&&this.footnote.draw(),this.get("border.enable")?this.T.box(0,0,this.width,this.height,this.get("border.width"),this.get("border.color"),this.get("border.radius"),this.get("background_color"),!0):this.T.backgound(0,0,this.width,this.height,this.get("background_color")));this.redraw=!0;!this.animationed&&this.get("animation")?(this.fireEvent(this,"beforeAnimation",[this]),this.animation(this)):(this.segmentRect(),this.components.eachAll(function(a){a.draw()},this),this.resetCanvas())},create:function(a){this.width=this.pushIf("width",400);this.height=this.pushIf("height",300);var b="width:"+this.width+"px;height:"+this.height+"px;padding:0px;overflow:hidden;position:relative;",c=h.iGather(this.type);this.shellid=h.iGather(this.type+"-shell");a.innerHTML="<div id='"+this.shellid+"' style='"+b+"'><canvas id= '"+c+"'  width='"+this.width+"' height="+this.height+"'><p>Your browser does not support the canvas element</p></canvas></div>";this.element=document.getElementById(c);this.shell=document.getElementById(this.shellid);this.T=this.target=new w(this.element);this.rendered=!0},render:function(a){this.push("render",a)},initialize:function(){if(!this.rendered){var a=this.get("render");"string"==typeof a&&document.getElementById(a)?this.create(document.getElementById(a)):"object"==typeof a&&this.create(a)}0<this.get("data").length&&this.rendered&&!this.initialization&&(h.Interface.parser.call(this,this.get("data")),this.doConfig(),this.initialization=!0)},doConfig:function(){h.Chart.superclass.doConfig.call(this);var a=this,b=a.variable.event,c=a.get("default_mouseover_css"),d,g;h.Assert.isArray(a.data);h.Interface._3D.call(a);a.T.strokeStyle(a.get("brushsize"),a.get("strokeStyle"),a.get("lineJoin"));a.processAnimation=a.get("animation");a.duration=Math.ceil(a.get("duration_animation_duration")*h.FRAME/1E3);a.variable.animation={type:0,time:0,queue:[]};a.animationArithmetic=h.getAnimationArithmetic(a.get("animation_timing_function"));a.on("afterAnimation",function(){var b=a.variable.animation.queue.shift();b&&a[b.handler].apply(a,b.arguments)});["click","dblclick","mousemove"].each(function(b){a.T.addEvent(b,function(c){a.processAnimation||a.fireEvent(a,b,[a,h.Event.fix(c)])},!1)});a.on("click",function(a,b){a.components.eachAll(function(a){if(!a.preventEvent){var c=a.isMouseOver(b);c.valid&&a.fireEvent(a,"click",[a,b,c])}})});a.on("mousemove",function(a,e){d=g=!1;a.components.eachAll(function(f){if(!f.preventEvent){var h=f.variable.event,k=f.isMouseOver(e);k.valid?(d=!0,g=g||f.atomic,b.mouseover||(b.mouseover=!0,a.fireEvent(a,"mouseover",[e])),c&&g&&a.T.css("cursor","pointer"),h.mouseover||(h.mouseover=!0,f.fireEvent(f,"mouseover",[e,k])),f.fireEvent(f,"mousemove",[e,k])):h.mouseover&&(h.mouseover=!1,f.fireEvent(f,"mouseout",[e,k]))}});c&&!g&&b.mouseover&&a.T.css("cursor","default");!d&&b.mouseover&&(b.mouseover=!1,a.fireEvent(a,"mouseout",[e]))});a.push("l_originx",a.get("padding_left"));a.push("r_originx",a.width-a.get("padding_right"));a.push("t_originy",a.get("padding_top"));a.push("b_originy",a.height-a.get("padding_bottom"));a.push("client_width",a.get("width")-a.get("hpadding"));var f=0;h.isString(a.get("title"))&&a.push("title",{text:a.get("title"),fontweight:"bold",fontsize:20,height:30});h.isString(a.get("subtitle"))&&a.push("subtitle",{text:a.get("subtitle"),fontweight:"bold",fontsize:16,height:20});h.isString(a.get("footnote"))&&a.push("footnote",{text:a.get("footnote"),color:"#5d7f97",height:20});if(""!=a.get("title.text")){var e=""!=a.get("subtitle.text"),f=e?a.get("title.height")+a.get("subtitle.height"):a.get("title.height");"left"==a.get("title_align")?a.push("title.originx",a.get("padding_left")):"right"==a.get("title_align")?a.push("title.originx",a.width-a.get("padding_right")):a.push("title.originx",a.get("padding_left")+a.get("client_width")/2);a.push("t_originy",a.get("t_originy")+f);this.push("title.textAlign",this.get("title_align"));this.push("title.originy",this.get("padding_top"));this.push("title.textBaseline","top");this.title=new h.Text(this.get("title"),this);e&&(a.push("subtitle.originx",a.get("title.originx")),a.push("subtitle.originy",a.get("title.originy")+a.get("title.height")),a.push("subtitle.textAlign",a.get("title_align")),a.push("subtitle.textBaseline","top"),this.subtitle=new h.Text(this.get("subtitle"),this))}""!=a.get("footnote.text")&&(e=a.get("footnote.height"),f+=e,a.push("b_originy",a.get("b_originy")-e),"left"==a.get("footnote_align")?a.push("footnote.originx",a.get("padding_left")):"right"==a.get("footnote_align")?a.push("footnote.originx",a.width-a.get("padding_right")):a.push("footnote.originx",a.get("padding_left")+a.get("client_width")/2),this.push("footnote.textAlign",this.get("footnote_align")),this.push("footnote.originy",this.get("b_originy")),this.push("footnote.textBaseline","top"),this.footnote=new h.Text(this.get("footnote"),this));a.push("client_height",a.get("height")-a.get("vpadding")-f);a.push("minDistance",Math.min(a.get("client_width"),a.get("client_height")));a.push("maxDistance",Math.max(a.get("client_width"),a.get("client_height")));a.push("minstr",a.get("client_width")<a.get("client_height")?"width":"height");a.push("centerx",a.get("l_originx")+a.get("client_width")/2);a.push("centery",a.get("t_originy")+a.get("client_height")/2);a.get("legend.enable")&&(a.legend=new h.Legend(h.apply({maxwidth:a.get("client_width"),data:a.data},a.get("legend")),a),a.components.push(a.legend));a.get("tip.enable")&&a.push("tip.wrap",a.shell)}})})(iChart);